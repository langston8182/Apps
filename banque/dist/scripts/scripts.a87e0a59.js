"use strict";angular.module("banqueApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).directive("login",function(){return function(a,b,c){a.$on("userInfo",function(c,d){a.userInfo.logged&&b.modal("hide")})}}).directive("erreurLogin",["$timeout",function(a){return{template:'<div class="alert alert-danger" role="alert" >Login ou mot de passe incorrect.</div>',link:function(b,c){c.hide(),b.$on("userInfo",function(d,e){b.userInfo.logged||(c.show(),a(function(){c.hide()},2e3))})}}}]).run(["$rootScope","$location","serviceAjax","$q",function(a,b,c,d){a.$on("$routeChangeStart",function(a){var e=c.getUserInfo();return e?d.when(e):(b.path("/"),d.reject({authenticated:!1}))})}]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/test",{templateUrl:"views/test.html",controller:"TestCtrl",controllerAs:"test"}).when("/ajouter",{templateUrl:"views/ajouter.html",controller:"AjouterCtrl",controllerAs:"ajouter"}).otherwise({redirectTo:"/"})}]),angular.module("banqueApp").controller("MainCtrl",["$scope","$location","serviceAjax","$window",function(a,b,c,d){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.isActive=function(a){return a===b.path()?"active":""},a.authenticate=function(){c.login(a.user).then(function(c){a.userInfo=angular.fromJson(d.sessionStorage.userInfo),a.$broadcast("userInfo",a.userInfo),b.path("/#/")},function(b){a.userInfo={logged:!1},a.$broadcast("userInfo",a.userInfo)})},a.dismiss=function(){if(a.userInfo)return"modal"},a.logout=function(){c.logout(),a.userInfo=null,b.path("/#/")}}]),angular.module("banqueApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("banqueApp").controller("TestCtrl",["$scope","serviceAjax","$route",function(a,b,c){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.users={},a.loadUsers=function(){b.users().then(function(b){a.users=b},function(a){console.log(a)})},a.supprimerUtilisateur=function(a){b.supprime(a),c.reload()},a.loadUser=function(c){b.user(c).then(function(b){a.user=angular.fromJson(b.data[0])},function(a){console.log(a)})},a.modifierUtilisateur=function(c){b.modifierUtilisateur(c,a.user.nom,a.user.prenom),a.loadUsers()},a.loadUsers()}]),angular.module("banqueApp").factory("serviceAjax",["$http","$q","$window",function(a,b,c){var d;return{users:function(){return a.get("http://localhost:3000/users/").then(function(a){return a.data})},supprime:function(b){return a.get("http://localhost:3000/supprime?id="+b)},user:function(b){return a.get("http://localhost:3000/user?id="+b)},modifierUtilisateur:function(b,c,d){return a.get("http://localhost:3000/modifierUtilisateur?id="+b+"&nom="+c+"&prenom="+d)},login:function(e){var f=b.defer();return a.post("http://localhost:3000/login/",e).then(function(a){d={token:a.data.token,login:a.data.login,logged:!0},c.sessionStorage.userInfo=JSON.stringify(d),f.resolve(d)},function(a){f.reject(a)}),f.promise},logout:function(){d=null,c.sessionStorage.userInfo=null},getUserInfo:function(){return d},ajout:function(b,c){return a.get("http://localhost:3000/ajout?nom="+b+"&prenom="+c)}}}]),angular.module("banqueApp").controller("AjouterCtrl",["$scope","serviceAjax","$timeout",function(a,b,c){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.ajouterUtilisateur=function(){function d(){a.nom="",a.prenom=""}b.ajout(a.nom,a.prenom),a.ajoutOK="L'utilisateur à été ajouté",c(function(){d()},2e3),a.isOK=!0}}]),angular.module("appApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/ajouter.html",'<form ng-submit="ajouterUtilisateur()" class="col-lg-10"> <legend>Ajout utilisateur</legend> <label for="nom">Nom : </label> <input type="text" ng-model="nom" class="form-control"> <label for="prenom">Prénom : </label> <input type="text" ng-model="prenom" class="form-control"> <br> <button type="submit" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Ajouter</button> </form> <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-show="isOK"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> <h4 class="modal-title" id="myModalLabel">Statut</h4> </div> <div class="modal-body"> Utilisateur ajouté </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="jumbotron"> <h1>\'Allo, \'Allo!</h1> <p class="lead"> <img src="images/yeoman.8cb970fb.png" alt="I\'m Yeoman"><br> Always a pleasure scaffolding your apps. </p> <p><a class="btn btn-lg btn-success" ng-href="#/">Splendid!<span class="glyphicon glyphicon-ok"></span></a></p> </div> <div class="row marketing"> <h4>HTML5 Boilerplate</h4> <p> HTML5 Boilerplate is a professional front-end template for building fast, robust, and adaptable web apps or sites. </p> <h4>Angular</h4> <p> AngularJS is a toolset for building the framework most suited to your application development. </p> <h4>Karma</h4> <p>Spectacular Test Runner for JavaScript.</p> </div>'),a.put("views/test.html",'<div class="panel panel-default"> <div class="panel-heading">Utilisateurs</div> <table class="table"> <tr ng-repeat="user in users"> <td>{{user.nom}}</td> <td>{{user.prenom}}</td> <td align="right"><button type="button" class="btn btn-danger" ng-click="supprimerUtilisateur(user._id)">Supprimer</button> <button type="button" class="btn btn-warning" ng-click="loadUser(user._id)" data-toggle="modal" data-target="#exampleModal">Modifier</button> </td></tr> </table> </div> <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> <h4 class="modal-title" id="exampleModalLabel">Modification</h4> </div> <div class="modal-body"> <form> <div class="form-group"> <label for="nom" class="form-control-label">Nom : </label> <input type="text" class="form-control" id="nom" ng-model="user.nom"> </div> <div class="form-group"> <label for="prenom" class="form-control-label">Prenom : </label> <input type="text" class="form-control" id="prenom" ng-model="user.prenom"> </div> </form> </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary" data-dismiss="modal">Fermer</button> <button type="button" class="btn btn-primary" ng-click="modifierUtilisateur(user._id)" data-dismiss="modal">Valider</button> </div> </div> </div> </div>')}]);